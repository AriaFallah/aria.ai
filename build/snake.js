!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=3)}([function(t,e,n){"use strict"},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Canvas=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();n(0);e.Canvas=function(){function t(e,n,r){i(this,t),this.canvas=e,this.canvasSize=n,this.cellSize=r,this.context=e.getContext("2d"),this.scaleCanvas()}return r(t,[{key:"drawBackground",value:function(){this.context.fillStyle="black",this.context.fillRect(0,0,this.canvasSize,this.canvasSize)}},{key:"isOutOfBounds",value:function(t){var e=t.x,n=t.y,i=this.canvasSize,r=this.cellSize;return e<0||n<0||e>=i/r||n>=i/r}},{key:"paintCell",value:function(t,e){var n=e.x,i=e.y,r=this.cellSize,o=this.context;o.fillStyle=t,o.strokeStyle=t,o.fillRect(n*r,i*r,r,r),o.strokeRect(n*r,i*r,r,r)}},{key:"randomPoint",value:function(){var t=this.canvasSize,e=this.cellSize;return{x:Math.round(Math.random()*(t-e)/e),y:Math.round(Math.random()*(t-e)/e)}}},{key:"scaleCanvas",value:function(){var t=this.canvas,e=this.context,n=this.canvasSize,i=window.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,o=i/r;i!==r?(t.width=n*o,t.height=n*o,t.style.width=n+"px",t.style.height=n+"px"):(t.width=n,t.height=n,t.style.width="",t.style.height=""),e.scale(o,o)}}]),t}()},function(t,e,n){"use strict";function i(t){if(null==t)throw new Error("Argument was null");return t}function r(t){for(var e=Array(t),n=0;n<t;++n)e[n]=n;return e}function o(t,e,n){return t*(1-n)+e*n}Object.defineProperty(e,"__esModule",{value:!0}),e.nullThrows=i,e.seq=r,e.interp=o},function(t,e,n){"use strict";n(0);var i=n(1),r=n(4),o=n(2),a=(0,o.nullThrows)(document.body),s=a.clientHeight,u=a.clientWidth,c=Math.round(.75*Math.min(s,u)),h=Math.round(c/25),l=Math.ceil(c/h+1)*h,d=new i.Canvas(document.getElementById("canvas"),l,h),f=new r.Game(d);document.addEventListener("keydown",f.onEvent),(0,o.nullThrows)(document.getElementById("left")).addEventListener("click",function(){return f.onTap("left")}),(0,o.nullThrows)(document.getElementById("right")).addEventListener("click",function(){return f.onTap("right")}),(0,o.nullThrows)(document.getElementById("up")).addEventListener("click",function(){return f.onTap("up")}),(0,o.nullThrows)(document.getElementById("down")).addEventListener("click",function(){return f.onTap("down")})},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){switch(t){case 37:return"left";case 38:return"up";case 39:return"right";case 40:return"down";default:return null}}Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();n(0);var a=n(2),s=n(5),u=n(6);n(1),e.Game=function(){function t(e){var n=this;i(this,t),this.steps=6,this.stepSize=1,this.t=0,this.onEvent=function(t){if(n.gameOver)return void n.startNewGame();if(t instanceof KeyboardEvent&&!t.repeat){var e=r(t.keyCode);e&&n.snake.queueMove(e)}},this.onTap=function(t){if(n.gameOver)return void n.startNewGame();n.snake.queueMove(t)},this.canvas=e,this.highScore=parseInt(localStorage.getItem("highScore"))||0,this.highScoreElement=(0,a.nullThrows)(document.getElementById("high-score")),this.scoreElement=(0,a.nullThrows)(document.getElementById("score")),this.highScoreElement.innerHTML=""+this.highScore,this.startNewGame()}return o(t,[{key:"draw",value:function(){this.canvas.drawBackground(),this.food.draw(this.canvas),this.snake.draw(this.canvas)}},{key:"getNextFoodPos",value:function(){var t=this.canvas.randomPoint(),e=!0,n=!1,i=void 0;try{for(var r,o=this.snake.body[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;if(a.x===t.x&&a.y===t.y)return null}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}return t}},{key:"gameLoop",value:function(){var t=this;this.gameOver||(this.draw(),this.update(),requestAnimationFrame(function(){return t.gameLoop()}))}},{key:"setScore",value:function(t){this.score=t,this.scoreElement.innerHTML=""+this.score,this.score>this.highScore&&(this.highScore=this.score,this.highScoreElement.innerHTML=""+this.highScore,localStorage.setItem("highScore",""+this.highScore))}},{key:"startNewGame",value:function(){var t=this;this.food=new s.Food(this.canvas.randomPoint()),this.gameOver=!1,this.setScore(0),this.snake=new u.Snake(this.canvas.canvasSize/this.canvas.cellSize),requestAnimationFrame(function(){return t.gameLoop()})}},{key:"update",value:function(){if(this.snake.update(this.t/this.steps),this.snake.isCollidingWithSelf())return void(this.gameOver=!0);var t=this.snake.body[0];if(t.x===this.food.x&&t.y===this.food.y){for(this.setScore(this.score+1);;){var e=this.getNextFoodPos();if(null!==e){this.food=new s.Food(e);break}}this.snake.grow()}this.t+=this.stepSize,this.t>this.steps&&(this.t=0)}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Food=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();n(0);n(1),e.Food=function(){function t(e){i(this,t),this.x=e.x,this.y=e.y}return r(t,[{key:"draw",value:function(t){t.paintCell("#fff",this)}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Segment=e.Snake=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();n(1);n(0);var o=n(2),a=(e.Snake=function(){function t(e){i(this,t),this.body=(0,o.seq)(5).reverse().map(function(t){return new a(t,0,"right")}),this.moveQueue=[],this.boardSize=e}return r(t,[{key:"draw",value:function(t){var e=!0,n=!1,i=void 0;try{for(var r,o=this.body[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;t.paintCell("#fff",a)}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}}},{key:"isCollidingWithSelf",value:function(){var t=this.body[0],e=!0,n=!1,i=void 0;try{for(var r,o=this.body.slice(1)[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;if(t.x===a.x&&t.y===a.y)return!0}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}return!1}},{key:"grow",value:function(){var t=this.body[this.body.length-1],e=t.direction,n=t.x,i=t.y;"right"===e?n-=1:"left"===e?n+=1:"up"===e?i+=1:"down"===e&&(i-=1),this.body.push(new a(n,i,e))}},{key:"update",value:function(t){if(0===t){for(var e=this.body.length-1;e>0;--e)this.body[e-1].didPivot&&(this.body[e].didPivot=!0,this.body[e].direction=this.body[e-1].direction,this.body[e-1].didPivot=!1),this.body[e].updatePosition=this.body[e].positionUpdater();this.moveQueue.length>0&&this.body[0].x<this.boardSize&&this.body[0].x>=0&&this.body[0].y<this.boardSize&&this.body[0].y>=0&&(this.body[0].direction=this.moveQueue.shift(),this.body[0].didPivot=!0),this.body[0].updatePosition=this.body[0].positionUpdater()}else{var n=!0,i=!1,r=void 0;try{for(var o,a=this.body[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.updatePosition(t),(s.x>this.boardSize+1||s.x<-1)&&(s.x=this.boardSize-s.x),(s.y>this.boardSize+1||s.y<-1)&&(s.y=this.boardSize-s.y)}}catch(t){i=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}}}},{key:"queueMove",value:function(e){if(!(this.moveQueue.length>=3)){var n=this.moveQueue.length>0?this.moveQueue[this.moveQueue.length-1]:this.body[0].direction;t.validMove(n,e)&&this.moveQueue.push(e)}}}],[{key:"validMove",value:function(t,e){return!("right"===t&&"left"===e||"left"===t&&"right"===e||"up"===t&&"down"===e||"down"===t&&"up"===e)}}]),t}(),e.Segment=function(){function t(e,n,r){i(this,t),this.x=e,this.y=n,this.didPivot=!1,this.direction=r,this.updatePosition=this.positionUpdater()}return r(t,[{key:"positionUpdater",value:function(){var t=this,e=this.x,n=this.y;switch(this.direction){case"left":return function(n){t.x=(0,o.interp)(e,e-1,n)};case"right":return function(n){t.x=(0,o.interp)(e,e+1,n)};case"up":return function(e){t.y=(0,o.interp)(n,n-1,e)};case"down":return function(e){t.y=(0,o.interp)(n,n+1,e)};default:throw new Error("Switch case should have been exhausted")}}}]),t}())}]);