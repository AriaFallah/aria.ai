var bundle=function(t){"use strict";var e=[];function s(t){if(void 0===t){var s=[e,0];return s.tag=256,s}if(null!==t&&t[0]===e){var i=t[1]+1|0,n=[e,i];return n.tag=256,n}return t}function i(t){return null===t||void 0===t?void 0:s(t)}function n(t){if(null!==t&&t[0]===e){var s=t[1];return 0===s?void 0:[e,s-1|0]}return t}var r=[0];var h,a=((h=["L-SnakeReason.NoneThrow",(r[0]+=1,r[0])]).tag=248,h);function o(t,e,s){return t*(1-s)+e*s}function l(t){return Math.floor(Math.random()*t)}function u(t){if(void 0!==t)return n(t);throw[a,"None value passed to unwrap"]}var c=["Invalid_argument",-3],f=["Division_by_zero",-5];function p(t,e,s){for(var i=new Array(s),n=0,r=e;n<s;)i[n]=t[r],n=n+1|0,r=r+1|0;return i}function g(t,e){if(e<0||e>=t.length)throw[c,"index out of bounds"];return t[e]}function d(t,e){for(;;){var s=e,i=t,n=i.length,r=0===n?1:n,h=r-s.length|0;if(0===h)return i.apply(null,s);if(!(h<0))return function(t,e){return function(s){return d(t,e.concat([s]))}}(i,s);e=p(s,r,0|-h),t=i.apply(null,p(s,0,r))}}function _(t,e){var s=t.length;return 1===s?t(e):function(t,e,s){if(s>7||s<0)return d(t,[e]);switch(s){case 0:case 1:return t(e);case 2:return function(s){return t(e,s)};case 3:return function(s,i){return t(e,s,i)};case 4:return function(s,i,n){return t(e,s,i,n)};case 5:return function(s,i,n,r){return t(e,s,i,n,r)};case 6:return function(s,i,n,r,h){return t(e,s,i,n,r,h)};case 7:return function(s,i,n,r,h,a){return t(e,s,i,n,r,h,a)}}}(t,e,s)}function y(t){return 1===t.length?t:function(e){return _(t,e)}}function v(t,e,s){var i=t.length;return 2===i?t(e,s):function(t,e,s,i){if(i>7||i<0)return d(t,[e,s]);switch(i){case 0:case 1:return d(t(e),[s]);case 2:return t(e,s);case 3:return function(i){return t(e,s,i)};case 4:return function(i,n){return t(e,s,i,n)};case 5:return function(i,n,r){return t(e,s,i,n,r)};case 6:return function(i,n,r,h){return t(e,s,i,n,r,h)};case 7:return function(i,n,r,h,a){return t(e,s,i,n,r,h,a)}}}(t,e,s,i)}c.tag=248,f.tag=248;var x=function(t,e){for(var s in t)e(s)};function b(t,e){for(;;){var s=e,i=t;if(i===s)return!0;var n=typeof i;if("string"===n||"number"===n||"boolean"===n||"undefined"===n||null===i)return!1;var r=typeof s;if("function"===n||"function"===r)throw[c,"equal: functional value"];if("number"===r||"undefined"===r||null===s)return!1;var h=0|i.tag,a=0|s.tag;if(250!==h)if(250!==a){if(248===h)return i[1]===s[1];if(251===h)throw[c,"equal: abstract value"];if(h!==a)return!1;if(256===h)return i[1]===s[1];var o=0|i.length;if(o!==(0|s.length))return!1;if(!Array.isArray(i)){var l=i,u=s,f=[!0],p=function(t,e){return function(s){return t.hasOwnProperty(s)?0:(e[0]=!1,0)}}(u,f),g=function(t,e,s){return function(i){return t.hasOwnProperty(i)&&b(e[i],t[i])?0:(s[0]=!1,0)}}(l,u,f);return x(l,p),f[0]&&x(u,g),f[0]}for(var d=i,_=s,y=0,v=o;;){var m=y;if(m===v)return!0;if(!b(d[m],_[m]))return!1;y=m+1|0}}else e=s[0];else t=i[0]}}function m(t,e){return function(t,e){if(t<=0)return[];for(var s=new Array(t),i=0,n=t-1|0;i<=n;++i)s[i]=e(i);return s}(t,y(e))}function w(t,e){return function(t,e){for(var s=t.length,i=new Array(s),n=0,r=s-1|0;n<=r;++n)i[n]=e(t[n]);return i}(t,y(e))}function M(t){if(t)return t[0];throw new Error("headExn")}function S(t){if(t)return t[1];throw new Error("tailExn")}function O(t,e){if(t){var s=[t[0],0];return(function(t,e){for(;;){var s=e,i=t;if(!i)return s;var n=[i[0],0];s[1]=n,e=n,t=i[1]}}(t[1],s))[1]=e,s}return e}function P(t,e){return function(t,e){if(t){var s=[e(t[0]),0];return function(t,e,s){for(;;){var i=e,n=t;if(!n)return 0;var r=[s(n[0]),0];i[1]=r,e=r,t=n[1]}}(t[1],s,e),s}return 0}(t,y(e))}function R(t,e,s){return function(t,e,s){for(;;){var i=t;if(!i)return!1;if(s(i[0],e))return!0;t=i[1]}}(t,e,2===(i=s).length?i:function(t,e){return v(i,t,e)});var i}function k(t,e){if(0===e)throw f;return t/e|0}var E=null;function A(t){var e=t.first;if(null!==e){var i=e.next;return null===i?(function(t){t.length=0,t.first=E,t.last=E}(t),s(e.content)):(t.length=t.length-1|0,t.first=i,s(e.content))}}class T{constructor(t,e,s,i){this.RoughSegmentRelationConst={LEFT:0,RIGHT:1,INTERSECTS:2,AHEAD:3,BEHIND:4,SEPARATE:5,UNDEFINED:6},this.px1=t,this.py1=e,this.px2=s,this.py2=i,this.xi=Number.MAX_VALUE,this.yi=Number.MAX_VALUE,this.a=i-e,this.b=t-s,this.c=s*e-t*i,this._undefined=0==this.a&&0==this.b&&0==this.c}isUndefined(){return this._undefined}compare(t){if(this.isUndefined()||t.isUndefined())return this.RoughSegmentRelationConst.UNDEFINED;var e=Number.MAX_VALUE,s=Number.MAX_VALUE,i=0,n=0,r=this.a,h=this.b,a=this.c;return Math.abs(h)>1e-5&&(e=-r/h,i=-a/h),Math.abs(t.b)>1e-5&&(s=-t.a/t.b,n=-t.c/t.b),e==Number.MAX_VALUE?s==Number.MAX_VALUE?-a/r!=-t.c/t.a?this.RoughSegmentRelationConst.SEPARATE:this.py1>=Math.min(t.py1,t.py2)&&this.py1<=Math.max(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.py2>=Math.min(t.py1,t.py2)&&this.py2<=Math.max(t.py1,t.py2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:(this.xi=this.px1,this.yi=s*this.xi+n,(this.py1-this.yi)*(this.yi-this.py2)<-1e-5||(t.py1-this.yi)*(this.yi-t.py2)<-1e-5?this.RoughSegmentRelationConst.SEPARATE:Math.abs(t.a)<1e-5&&(t.px1-this.xi)*(this.xi-t.px2)<-1e-5?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS):s==Number.MAX_VALUE?(this.xi=t.px1,this.yi=e*this.xi+i,(t.py1-this.yi)*(this.yi-t.py2)<-1e-5||(this.py1-this.yi)*(this.yi-this.py2)<-1e-5?this.RoughSegmentRelationConst.SEPARATE:Math.abs(r)<1e-5&&(this.px1-this.xi)*(this.xi-this.px2)<-1e-5?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS):e==s?i!=n?this.RoughSegmentRelationConst.SEPARATE:this.px1>=Math.min(t.px1,t.px2)&&this.px1<=Math.max(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.px2>=Math.min(t.px1,t.px2)&&this.px2<=Math.max(t.px1,t.px2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:(this.xi=(n-i)/(e-s),this.yi=e*this.xi+i,(this.px1-this.xi)*(this.xi-this.px2)<-1e-5||(t.px1-this.xi)*(this.xi-t.px2)<-1e-5?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS)}getLength(){return this._getLength(this.px1,this.py1,this.px2,this.py2)}_getLength(t,e,s,i){var n=s-t,r=i-e;return Math.sqrt(n*n+r*r)}}class C{constructor(t,e,s,i,n,r,h,a){this.top=t,this.bottom=e,this.left=s,this.right=i,this.gap=n,this.sinAngle=r,this.tanAngle=a,Math.abs(r)<1e-4?this.pos=s+n:Math.abs(r)>.9999?this.pos=t+n:(this.deltaX=(e-t)*Math.abs(a),this.pos=s-Math.abs(this.deltaX),this.hGap=Math.abs(n/h),this.sLeft=new T(s,e,s,t),this.sRight=new T(i,e,i,t))}getNextLine(){if(Math.abs(this.sinAngle)<1e-4){if(this.pos<this.right){let t=[this.pos,this.top,this.pos,this.bottom];return this.pos+=this.gap,t}}else if(Math.abs(this.sinAngle)>.9999){if(this.pos<this.bottom){let t=[this.left,this.pos,this.right,this.pos];return this.pos+=this.gap,t}}else{let t=this.pos-this.deltaX/2,e=this.pos+this.deltaX/2,s=this.bottom,i=this.top;if(this.pos<this.right+this.deltaX){for(;t<this.left&&e<this.left||t>this.right&&e>this.right;)if(this.pos+=this.hGap,t=this.pos-this.deltaX/2,e=this.pos+this.deltaX/2,this.pos>this.right+this.deltaX)return null;let n=new T(t,s,e,i);2==n.compare(this.sLeft)&&(t=n.xi,s=n.yi),2==n.compare(this.sRight)&&(e=n.xi,i=n.yi),this.tanAngle>0&&(t=this.right-(t-this.left),e=this.right-(e-this.left));let r=[t,s,e,i];return this.pos+=this.hGap,r}}return null}}class L{constructor(t,e){this.type=t,this.text=e}isType(t){return this.type===t}}class I{constructor(t){this.PARAMS={A:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],a:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],C:["x1","y1","x2","y2","x","y"],c:["x1","y1","x2","y2","x","y"],H:["x"],h:["x"],L:["x","y"],l:["x","y"],M:["x","y"],m:["x","y"],Q:["x1","y1","x","y"],q:["x1","y1","x","y"],S:["x2","y2","x","y"],s:["x2","y2","x","y"],T:["x","y"],t:["x","y"],V:["y"],v:["y"],Z:[],z:[]},this.COMMAND=0,this.NUMBER=1,this.EOD=2,this.segments=[],this.d=t||"",this.parseData(t),this.processPoints()}loadFromSegments(t){this.segments=t,this.processPoints()}processPoints(){let t=null,e=[0,0];for(let s=0;s<this.segments.length;s++){let i=this.segments[s];switch(i.key){case"M":case"L":case"T":i.point=[i.data[0],i.data[1]];break;case"m":case"l":case"t":i.point=[i.data[0]+e[0],i.data[1]+e[1]];break;case"H":i.point=[i.data[0],e[1]];break;case"h":i.point=[i.data[0]+e[0],e[1]];break;case"V":i.point=[e[0],i.data[0]];break;case"v":i.point=[e[0],i.data[0]+e[1]];break;case"z":case"Z":t&&(i.point=[t[0],t[1]]);break;case"C":i.point=[i.data[4],i.data[5]];break;case"c":i.point=[i.data[4]+e[0],i.data[5]+e[1]];break;case"S":i.point=[i.data[2],i.data[3]];break;case"s":i.point=[i.data[2]+e[0],i.data[3]+e[1]];break;case"Q":i.point=[i.data[2],i.data[3]];break;case"q":i.point=[i.data[2]+e[0],i.data[3]+e[1]];break;case"A":i.point=[i.data[5],i.data[6]];break;case"a":i.point=[i.data[5]+e[0],i.data[6]+e[1]]}"m"!==i.key&&"M"!==i.key||(t=null),i.point&&(e=i.point,t||(t=i.point)),"z"!==i.key&&"Z"!==i.key||(t=null)}}get closed(){if(void 0===this._closed){this._closed=!1;for(let t of this.segments)"z"===t.key.toLowerCase()&&(this._closed=!0)}return this._closed}parseData(t){var e=this.tokenize(t),s=0,i=e[s],n="BOD";for(this.segments=new Array;!i.isType(this.EOD);){var r,h=new Array;if("BOD"==n){if("M"!=i.text&&"m"!=i.text)return this.parseData("M0,0"+t);s++,r=this.PARAMS[i.text].length,n=i.text}else i.isType(this.NUMBER)?r=this.PARAMS[n].length:(s++,r=this.PARAMS[i.text].length,n=i.text);if(s+r<e.length){for(var a=s;a<s+r;a++){var o=e[a];if(!o.isType(this.NUMBER))return void console.error("Parameter type is not a number: "+n+","+o.text);h[h.length]=o.text}var l;if(!this.PARAMS[n])return void console.error("Unsupported segment type: "+n);l={key:n,data:h},this.segments.push(l),i=e[s+=r],"M"==n&&(n="L"),"m"==n&&(n="l")}else console.error("Path data ended before all parameters were found")}}tokenize(t){for(var e=new Array;""!=t;)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]=new L(this.COMMAND,RegExp.$1),t=t.substr(RegExp.$1.length);else{if(!t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return console.error("Unrecognized segment command: "+t),null;e[e.length]=new L(this.NUMBER,parseFloat(RegExp.$1)),t=t.substr(RegExp.$1.length)}return e[e.length]=new L(this.EOD,null),e}}class N{constructor(t){this.d=t,this.parsed=new I(t),this._position=[0,0],this.bezierReflectionPoint=null,this.quadReflectionPoint=null,this._first=null}get segments(){return this.parsed.segments}get closed(){return this.parsed.closed}get linearPoints(){if(!this._linearPoints){const t=[];let e=[];for(let s of this.parsed.segments){let i=s.key.toLowerCase();("m"!==i&&"z"!==i||(e.length&&(t.push(e),e=[]),"z"!==i))&&(s.point&&e.push(s.point))}e.length&&(t.push(e),e=[]),this._linearPoints=t}return this._linearPoints}get first(){return this._first}set first(t){this._first=t}setPosition(t,e){this._position=[t,e],this._first||(this._first=[t,e])}get position(){return this._position}get x(){return this._position[0]}get y(){return this._position[1]}}class q{constructor(t,e,s,i,n,r){const h=Math.PI/180;if(this._segIndex=0,this._numSegs=0,t[0]==e[0]&&t[1]==e[1])return;this._rx=Math.abs(s[0]),this._ry=Math.abs(s[1]),this._sinPhi=Math.sin(i*h),this._cosPhi=Math.cos(i*h);var a,o=this._cosPhi*(t[0]-e[0])/2+this._sinPhi*(t[1]-e[1])/2,l=-this._sinPhi*(t[0]-e[0])/2+this._cosPhi*(t[1]-e[1])/2,u=this._rx*this._rx*this._ry*this._ry-this._rx*this._rx*l*l-this._ry*this._ry*o*o;if(u<0){let t=Math.sqrt(1-u/(this._rx*this._rx*this._ry*this._ry));this._rx=t,this._ry=t,a=0}else a=(n==r?-1:1)*Math.sqrt(u/(this._rx*this._rx*l*l+this._ry*this._ry*o*o));let c=a*this._rx*l/this._ry,f=-a*this._ry*o/this._rx;this._C=[0,0],this._C[0]=this._cosPhi*c-this._sinPhi*f+(t[0]+e[0])/2,this._C[1]=this._sinPhi*c+this._cosPhi*f+(t[1]+e[1])/2,this._theta=this.calculateVectorAngle(1,0,(o-c)/this._rx,(l-f)/this._ry);let p=this.calculateVectorAngle((o-c)/this._rx,(l-f)/this._ry,(-o-c)/this._rx,(-l-f)/this._ry);!r&&p>0?p-=2*Math.PI:r&&p<0&&(p+=2*Math.PI),this._numSegs=Math.ceil(Math.abs(p/(Math.PI/2))),this._delta=p/this._numSegs,this._T=8/3*Math.sin(this._delta/4)*Math.sin(this._delta/4)/Math.sin(this._delta/2),this._from=t}getNextSegment(){var t,e,s;if(this._segIndex==this._numSegs)return null;let i=Math.cos(this._theta),n=Math.sin(this._theta),r=this._theta+this._delta,h=Math.cos(r),a=Math.sin(r);return s=[this._cosPhi*this._rx*h-this._sinPhi*this._ry*a+this._C[0],this._sinPhi*this._rx*h+this._cosPhi*this._ry*a+this._C[1]],t=[this._from[0]+this._T*(-this._cosPhi*this._rx*n-this._sinPhi*this._ry*i),this._from[1]+this._T*(-this._sinPhi*this._rx*n+this._cosPhi*this._ry*i)],e=[s[0]+this._T*(this._cosPhi*this._rx*a+this._sinPhi*this._ry*h),s[1]+this._T*(this._sinPhi*this._rx*a-this._cosPhi*this._ry*h)],this._theta=r,this._from=[s[0],s[1]],this._segIndex++,{cp1:t,cp2:e,to:s}}calculateVectorAngle(t,e,s,i){let n=Math.atan2(e,t),r=Math.atan2(i,s);return r>=n?r-n:2*Math.PI-(n-r)}}class z{constructor(t,e){this.sets=t,this.closed=e}fit(t){let e=[];for(const s of this.sets){let i=s.length,n=Math.floor(t*i);if(n<5){if(i<=5)continue;n=5}e.push(this.reduce(s,n))}let s="";for(const t of e){for(let e=0;e<t.length;e++){let i=t[e];s+=0===e?"M"+i[0]+","+i[1]:"L"+i[0]+","+i[1]}this.closed&&(s+="z ")}return s}distance(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}reduce(t,e){if(t.length<=e)return t;let s=t.slice(0);for(;s.length>e;){let t=-1,e=-1;for(let i=1;i<s.length-1;i++){let n=this.distance(s[i-1],s[i]),r=this.distance(s[i],s[i+1]),h=this.distance(s[i-1],s[i+1]),a=(n+r+h)/2,o=Math.sqrt(a*(a-n)*(a-r)*(a-h));(t<0||o<t)&&(t=o,e=i)}if(!(e>0))break;s.splice(e,1)}return s}}class D{line(t,e,s,i,n){return{type:"path",ops:this._doubleLine(t,e,s,i,n)}}linearPath(t,e,s){const i=(t||[]).length;if(i>2){let n=[];for(let e=0;e<i-1;e++)n=n.concat(this._doubleLine(t[e][0],t[e][1],t[e+1][0],t[e+1][1],s));return e&&(n=n.concat(this._doubleLine(t[i-1][0],t[i-1][1],t[0][0],t[0][1],s))),{type:"path",ops:n}}if(2===i)return this.line(t[0][0],t[0][1],t[1][0],t[1][1],s)}polygon(t,e){return this.linearPath(t,!0,e)}rectangle(t,e,s,i,n){let r=[[t,e],[t+s,e],[t+s,e+i],[t,e+i]];return this.polygon(r,n)}curve(t,e){let s=this._curveWithOffset(t,1*(1+.2*e.roughness),e),i=this._curveWithOffset(t,1.5*(1+.22*e.roughness),e);return{type:"path",ops:s.concat(i)}}ellipse(t,e,s,i,n){const r=2*Math.PI/n.curveStepCount;let h=Math.abs(s/2),a=Math.abs(i/2);h+=this._getOffset(.05*-h,.05*h,n),a+=this._getOffset(.05*-a,.05*a,n);let o=this._ellipse(r,t,e,h,a,1,r*this._getOffset(.1,this._getOffset(.4,1,n),n),n),l=this._ellipse(r,t,e,h,a,1.5,0,n);return{type:"path",ops:o.concat(l)}}arc(t,e,s,i,n,r,h,a,o){let l=t,u=e,c=Math.abs(s/2),f=Math.abs(i/2);c+=this._getOffset(.01*-c,.01*c,o),f+=this._getOffset(.01*-f,.01*f,o);let p=n,g=r;for(;p<0;)p+=2*Math.PI,g+=2*Math.PI;g-p>2*Math.PI&&(p=0,g=2*Math.PI);let d=2*Math.PI/o.curveStepCount,_=Math.min(d/2,(g-p)/2),y=this._arc(_,l,u,c,f,p,g,1,o),v=this._arc(_,l,u,c,f,p,g,1.5,o),x=y.concat(v);return h&&(a?x=(x=x.concat(this._doubleLine(l,u,l+c*Math.cos(p),u+f*Math.sin(p),o))).concat(this._doubleLine(l,u,l+c*Math.cos(g),u+f*Math.sin(g),o)):(x.push({op:"lineTo",data:[l,u]}),x.push({op:"lineTo",data:[l+c*Math.cos(p),u+f*Math.sin(p)]}))),{type:"path",ops:x}}hachureFillArc(t,e,s,i,n,r,h){let a=t,o=e,l=Math.abs(s/2),u=Math.abs(i/2);l+=this._getOffset(.01*-l,.01*l,h),u+=this._getOffset(.01*-u,.01*u,h);let c=n,f=r;for(;c<0;)c+=2*Math.PI,f+=2*Math.PI;f-c>2*Math.PI&&(c=0,f=2*Math.PI);let p=(f-c)/h.curveStepCount,g=[],d=[];for(let t=c;t<=f;t+=p)g.push(a+l*Math.cos(t)),d.push(o+u*Math.sin(t));return g.push(a+l*Math.cos(f)),d.push(o+u*Math.sin(f)),g.push(a),d.push(o),this.hachureFillShape(g,d,h)}solidFillShape(t,e,s){let i=[];if(t&&e&&t.length&&e.length&&t.length===e.length){let r=s.maxRandomnessOffset||0;const h=t.length;if(h>2){i.push({op:"move",data:[t[0]+this._getOffset(-r,r,s),e[0]+this._getOffset(-r,r,s)]});for(var n=1;n<h;n++)i.push({op:"lineTo",data:[t[n]+this._getOffset(-r,r,s),e[n]+this._getOffset(-r,r,s)]})}}return{type:"fillPath",ops:i}}hachureFillShape(t,e,s){let i=[];if(t&&e&&t.length&&e.length){let n=t[0],r=t[0],h=e[0],a=e[0];for(let s=1;s<t.length;s++)n=Math.min(n,t[s]),r=Math.max(r,t[s]),h=Math.min(h,e[s]),a=Math.max(a,e[s]);const o=s.hachureAngle;let l=s.hachureGap;l<0&&(l=4*s.strokeWidth),l=Math.max(l,.1);const u=o%180*(Math.PI/180),c=Math.cos(u),f=Math.sin(u),p=Math.tan(u),g=new C(h-1,a+1,n-1,r+1,l,f,c,p);let d;for(;null!=(d=g.getNextLine());){let n=this._getIntersectingLines(d,t,e);for(let t=0;t<n.length;t++)if(t<n.length-1){let e=n[t],r=n[t+1];i=i.concat(this._doubleLine(e[0],e[1],r[0],r[1],s))}}}return{type:"fillSketch",ops:i}}hachureFillEllipse(t,e,s,i,n){let r=[],h=Math.abs(s/2),a=Math.abs(i/2);h+=this._getOffset(.05*-h,.05*h,n),a+=this._getOffset(.05*-a,.05*a,n);let o=n.hachureAngle,l=n.hachureGap;l<=0&&(l=4*n.strokeWidth);let u=n.fillWeight;u<0&&(u=n.strokeWidth/2);let c=o%180*(Math.PI/180),f=Math.tan(c),p=a/h,g=Math.sqrt(p*f*p*f+1),d=p*f/g,_=1/g,y=l/(h*a/Math.sqrt(a*_*(a*_)+h*d*(h*d))/h),v=Math.sqrt(h*h-(t-h+y)*(t-h+y));for(var x=t-h+y;x<t+h;x+=y){v=Math.sqrt(h*h-(t-x)*(t-x));let s=this._affine(x,e-v,t,e,d,_,p),i=this._affine(x,e+v,t,e,d,_,p);r=r.concat(this._doubleLine(s[0],s[1],i[0],i[1],n))}return{type:"fillSketch",ops:r}}svgPath(t,e){t=(t||"").replace(/\n/g," ").replace(/(-)/g," -").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let s=new N(t);if(e.simplification){let t=new z(s.linearPoints,s.closed).fit(e.simplification);s=new N(t)}let i=[],n=s.segments||[];for(let t=0;t<n.length;t++){let r=n[t],h=t>0?n[t-1]:null,a=this._processSegment(s,r,h,e);a&&a.length&&(i=i.concat(a))}return{type:"path",ops:i}}_bezierTo(t,e,s,i,n,r,h,a){let o=[],l=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.5],u=null;for(let c=0;c<2;c++)0===c?o.push({op:"move",data:[h.x,h.y]}):o.push({op:"move",data:[h.x+this._getOffset(-l[0],l[0],a),h.y+this._getOffset(-l[0],l[0],a)]}),u=[n+this._getOffset(-l[c],l[c],a),r+this._getOffset(-l[c],l[c],a)],o.push({op:"bcurveTo",data:[t+this._getOffset(-l[c],l[c],a),e+this._getOffset(-l[c],l[c],a),s+this._getOffset(-l[c],l[c],a),i+this._getOffset(-l[c],l[c],a),u[0],u[1]]});return h.setPosition(u[0],u[1]),o}_processSegment(t,e,s,i){let n=[];switch(e.key){case"M":case"m":{let s="m"===e.key;if(e.data.length>=2){let r=+e.data[0],h=+e.data[1];s&&(r+=t.x,h+=t.y);let a=1*(i.maxRandomnessOffset||0);r+=this._getOffset(-a,a,i),h+=this._getOffset(-a,a,i),t.setPosition(r,h),n.push({op:"move",data:[r,h]})}break}case"L":case"l":{let s="l"===e.key;if(e.data.length>=2){let r=+e.data[0],h=+e.data[1];s&&(r+=t.x,h+=t.y),n=n.concat(this._doubleLine(t.x,t.y,r,h,i)),t.setPosition(r,h)}break}case"H":case"h":{const s="h"===e.key;if(e.data.length){let r=+e.data[0];s&&(r+=t.x),n=n.concat(this._doubleLine(t.x,t.y,r,t.y,i)),t.setPosition(r,t.y)}break}case"V":case"v":{const s="v"===e.key;if(e.data.length){let r=+e.data[0];s&&(r+=t.y),n=n.concat(this._doubleLine(t.x,t.y,t.x,r,i)),t.setPosition(t.x,r)}break}case"Z":case"z":t.first&&(n=n.concat(this._doubleLine(t.x,t.y,t.first[0],t.first[1],i)),t.setPosition(t.first[0],t.first[1]),t.first=null);break;case"C":case"c":{const s="c"===e.key;if(e.data.length>=6){let r=+e.data[0],h=+e.data[1],a=+e.data[2],o=+e.data[3],l=+e.data[4],u=+e.data[5];s&&(r+=t.x,a+=t.x,l+=t.x,h+=t.y,o+=t.y,u+=t.y);let c=this._bezierTo(r,h,a,o,l,u,t,i);n=n.concat(c),t.bezierReflectionPoint=[l+(l-a),u+(u-o)]}break}case"S":case"s":{const h="s"===e.key;if(e.data.length>=4){let a=+e.data[0],o=+e.data[1],l=+e.data[2],u=+e.data[3];h&&(a+=t.x,l+=t.x,o+=t.y,u+=t.y);let c=a,f=o,p=s?s.key:"";var r=null;"c"!=p&&"C"!=p&&"s"!=p&&"S"!=p||(r=t.bezierReflectionPoint),r&&(c=r[0],f=r[1]);let g=this._bezierTo(c,f,a,o,l,u,t,i);n=n.concat(g),t.bezierReflectionPoint=[l+(l-a),u+(u-o)]}break}case"Q":case"q":{const s="q"===e.key;if(e.data.length>=4){let r=+e.data[0],h=+e.data[1],a=+e.data[2],o=+e.data[3];s&&(r+=t.x,a+=t.x,h+=t.y,o+=t.y);let l=1*(1+.2*i.roughness),u=1.5*(1+.22*i.roughness);n.push({op:"move",data:[t.x+this._getOffset(-l,l,i),t.y+this._getOffset(-l,l,i)]});let c=[a+this._getOffset(-l,l,i),o+this._getOffset(-l,l,i)];n.push({op:"qcurveTo",data:[r+this._getOffset(-l,l,i),h+this._getOffset(-l,l,i),c[0],c[1]]}),n.push({op:"move",data:[t.x+this._getOffset(-u,u,i),t.y+this._getOffset(-u,u,i)]}),c=[a+this._getOffset(-u,u,i),o+this._getOffset(-u,u,i)],n.push({op:"qcurveTo",data:[r+this._getOffset(-u,u,i),h+this._getOffset(-u,u,i),c[0],c[1]]}),t.setPosition(c[0],c[1]),t.quadReflectionPoint=[a+(a-r),o+(o-h)]}break}case"T":case"t":{const h="t"===e.key;if(e.data.length>=2){let a=+e.data[0],o=+e.data[1];h&&(a+=t.x,o+=t.y);let l=a,u=o,c=s?s.key:"";r=null;"q"!=c&&"Q"!=c&&"t"!=c&&"T"!=c||(r=t.quadReflectionPoint),r&&(l=r[0],u=r[1]);let f=1*(1+.2*i.roughness),p=1.5*(1+.22*i.roughness);n.push({op:"move",data:[t.x+this._getOffset(-f,f,i),t.y+this._getOffset(-f,f,i)]});let g=[a+this._getOffset(-f,f,i),o+this._getOffset(-f,f,i)];n.push({op:"qcurveTo",data:[l+this._getOffset(-f,f,i),u+this._getOffset(-f,f,i),g[0],g[1]]}),n.push({op:"move",data:[t.x+this._getOffset(-p,p,i),t.y+this._getOffset(-p,p,i)]}),g=[a+this._getOffset(-p,p,i),o+this._getOffset(-p,p,i)],n.push({op:"qcurveTo",data:[l+this._getOffset(-p,p,i),u+this._getOffset(-p,p,i),g[0],g[1]]}),t.setPosition(g[0],g[1]),t.quadReflectionPoint=[a+(a-l),o+(o-u)]}break}case"A":case"a":{const s="a"===e.key;if(e.data.length>=7){let r=+e.data[0],h=+e.data[1],a=+e.data[2],o=+e.data[3],l=+e.data[4],u=+e.data[5],c=+e.data[6];if(s&&(u+=t.x,c+=t.y),u==t.x&&c==t.y)break;if(0==r||0==h)n=n.concat(this._doubleLine(t.x,t.y,u,c,i)),t.setPosition(u,c);else{i.maxRandomnessOffset;for(let e=0;e<1;e++){let e=new q([t.x,t.y],[u,c],[r,h],a,!!o,!!l),s=e.getNextSegment();for(;s;){let r=this._bezierTo(s.cp1[0],s.cp1[1],s.cp2[0],s.cp2[1],s.to[0],s.to[1],t,i);n=n.concat(r),s=e.getNextSegment()}}}}break}}return n}_getOffset(t,e,s){return s.roughness*(Math.random()*(e-t)+t)}_affine(t,e,s,i,n,r,h){return[-s*r-i*n+s+r*t+n*e,h*(s*n-i*r)+i+-h*n*t+h*r*e]}_doubleLine(t,e,s,i,n){const r=this._line(t,e,s,i,n,!0,!1),h=this._line(t,e,s,i,n,!0,!0);return r.concat(h)}_line(t,e,s,i,n,r,h){const a=Math.pow(t-s,2)+Math.pow(e-i,2);let o=n.maxRandomnessOffset||0;o*o*100>a&&(o=Math.sqrt(a)/10);const l=o/2,u=.2+.2*Math.random();let c=n.bowing*n.maxRandomnessOffset*(i-e)/200,f=n.bowing*n.maxRandomnessOffset*(t-s)/200;c=this._getOffset(-c,c,n),f=this._getOffset(-f,f,n);let p=[];return r&&(h?p.push({op:"move",data:[t+this._getOffset(-l,l,n),e+this._getOffset(-l,l,n)]}):p.push({op:"move",data:[t+this._getOffset(-o,o,n),e+this._getOffset(-o,o,n)]})),h?p.push({op:"bcurveTo",data:[c+t+(s-t)*u+this._getOffset(-l,l,n),f+e+(i-e)*u+this._getOffset(-l,l,n),c+t+2*(s-t)*u+this._getOffset(-l,l,n),f+e+2*(i-e)*u+this._getOffset(-l,l,n),s+this._getOffset(-l,l,n),i+this._getOffset(-l,l,n)]}):p.push({op:"bcurveTo",data:[c+t+(s-t)*u+this._getOffset(-o,o,n),f+e+(i-e)*u+this._getOffset(-o,o,n),c+t+2*(s-t)*u+this._getOffset(-o,o,n),f+e+2*(i-e)*u+this._getOffset(-o,o,n),s+this._getOffset(-o,o,n),i+this._getOffset(-o,o,n)]}),p}_curve(t,e,s){const i=t.length;let n=[];if(i>3){const r=[],h=1-s.curveTightness;n.push({op:"move",data:[t[1][0],t[1][1]]});for(let e=1;e+2<i;e++){const s=t[e];r[0]=[s[0],s[1]],r[1]=[s[0]+(h*t[e+1][0]-h*t[e-1][0])/6,s[1]+(h*t[e+1][1]-h*t[e-1][1])/6],r[2]=[t[e+1][0]+(h*t[e][0]-h*t[e+2][0])/6,t[e+1][1]+(h*t[e][1]-h*t[e+2][1])/6],r[3]=[t[e+1][0],t[e+1][1]],n.push({op:"bcurveTo",data:[r[1][0],r[1][1],r[2][0],r[2][1],r[3][0],r[3][1]]})}if(e&&2===e.length){let t=s.maxRandomnessOffset;n.push({ops:"lineTo",data:[e[0]+this._getOffset(-t,t,s),e[1]+ +this._getOffset(-t,t,s)]})}}else 3===i?(n.push({op:"move",data:[t[1][0],t[1][1]]}),n.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):2===i&&(n=n.concat(this._doubleLine(t[0][0],t[0][1],t[1][0],t[1][1],s)));return n}_ellipse(t,e,s,i,n,r,h,a){const o=this._getOffset(-.5,.5,a)-Math.PI/2,l=[];l.push([this._getOffset(-r,r,a)+e+.9*i*Math.cos(o-t),this._getOffset(-r,r,a)+s+.9*n*Math.sin(o-t)]);for(let h=o;h<2*Math.PI+o-.01;h+=t)l.push([this._getOffset(-r,r,a)+e+i*Math.cos(h),this._getOffset(-r,r,a)+s+n*Math.sin(h)]);return l.push([this._getOffset(-r,r,a)+e+i*Math.cos(o+2*Math.PI+.5*h),this._getOffset(-r,r,a)+s+n*Math.sin(o+2*Math.PI+.5*h)]),l.push([this._getOffset(-r,r,a)+e+.98*i*Math.cos(o+h),this._getOffset(-r,r,a)+s+.98*n*Math.sin(o+h)]),l.push([this._getOffset(-r,r,a)+e+.9*i*Math.cos(o+.5*h),this._getOffset(-r,r,a)+s+.9*n*Math.sin(o+.5*h)]),this._curve(l,null,a)}_curveWithOffset(t,e,s){const i=[];i.push([t[0][0]+this._getOffset(-e,e,s),t[0][1]+this._getOffset(-e,e,s)]),i.push([t[0][0]+this._getOffset(-e,e,s),t[0][1]+this._getOffset(-e,e,s)]);for(let n=1;n<t.length;n++)i.push([t[n][0]+this._getOffset(-e,e,s),t[n][1]+this._getOffset(-e,e,s)]),n===t.length-1&&i.push([t[n][0]+this._getOffset(-e,e,s),t[n][1]+this._getOffset(-e,e,s)]);return this._curve(i,null,s)}_arc(t,e,s,i,n,r,h,a,o){const l=r+this._getOffset(-.1,.1,o),u=[];u.push([this._getOffset(-a,a,o)+e+.9*i*Math.cos(l-t),this._getOffset(-a,a,o)+s+.9*n*Math.sin(l-t)]);for(let r=l;r<=h;r+=t)u.push([this._getOffset(-a,a,o)+e+i*Math.cos(r),this._getOffset(-a,a,o)+s+n*Math.sin(r)]);return u.push([e+i*Math.cos(h),s+n*Math.sin(h)]),u.push([e+i*Math.cos(h),s+n*Math.sin(h)]),this._curve(u,null,o)}_getIntersectingLines(t,e,s){let i=[];for(var n=new T(t[0],t[1],t[2],t[3]),r=0;r<e.length;r++){let t=new T(e[r],s[r],e[(r+1)%e.length],s[(r+1)%e.length]);2==n.compare(t)&&i.push([n.xi,n.yi])}return i}}self._roughScript=self.document&&self.document.currentScript&&self.document.currentScript.src;class F{constructor(t,e){this.config=t||{},this.canvas=e,this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveStepCount:9,fill:null,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1},this.config.options&&(this.defaultOptions=this._options(this.config.options))}_options(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_drawable(t,e,s){return{shape:t,sets:e||[],options:s||this.defaultOptions}}get lib(){if(!this._renderer)if(self&&self.workly&&this.config.async&&!this.config.noWorker){Function.prototype.toString;const t=this.config.worklyURL||"https://cdn.jsdelivr.net/gh/pshihn/workly/dist/workly.min.js",e=this.config.roughURL||self._roughScript;if(e&&t){let s=`importScripts('${t}', '${e}');\nworkly.expose(self.rough.createRenderer());`,i=URL.createObjectURL(new Blob([s]));this._renderer=workly.proxy(i)}else this._renderer=new D}else this._renderer=new D;return this._renderer}line(t,e,s,i,n){const r=this._options(n);return this._drawable("line",[this.lib.line(t,e,s,i,r)],r)}rectangle(t,e,s,i,n){const r=this._options(n),h=[];if(r.fill){const n=[t,t+s,t+s,t],a=[e,e,e+i,e+i];"solid"===r.fillStyle?h.push(this.lib.solidFillShape(n,a,r)):h.push(this.lib.hachureFillShape(n,a,r))}return h.push(this.lib.rectangle(t,e,s,i,r)),this._drawable("rectangle",h,r)}ellipse(t,e,s,i,n){const r=this._options(n),h=[];if(r.fill)if("solid"===r.fillStyle){const n=this.lib.ellipse(t,e,s,i,r);n.type="fillPath",h.push(n)}else h.push(this.lib.hachureFillEllipse(t,e,s,i,r));return h.push(this.lib.ellipse(t,e,s,i,r)),this._drawable("ellipse",h,r)}circle(t,e,s,i){let n=this.ellipse(t,e,s,s,i);return n.shape="circle",n}linearPath(t,e){const s=this._options(e);return this._drawable("linearPath",[this.lib.linearPath(t,!1,s)],s)}polygon(t,e){const s=this._options(e),i=[];if(s.fill){let e=[],n=[];for(let s of t)e.push(s[0]),n.push(s[1]);"solid"===s.fillStyle?i.push(this.lib.solidFillShape(e,n,s)):i.push(this.lib.hachureFillShape(e,n,s))}return i.push(this.lib.linearPath(t,!0,s)),this._drawable("polygon",i,s)}arc(t,e,s,i,n,r,h,a){const o=this._options(a),l=[];if(h&&o.fill)if("solid"===o.fillStyle){let h=this.lib.arc(t,e,s,i,n,r,!0,!1,o);h.type="fillPath",l.push(h)}else l.push(this.lib.hachureFillArc(t,e,s,i,n,r,o));return l.push(this.lib.arc(t,e,s,i,n,r,h,!0,o)),this._drawable("arc",l,o)}curve(t,e){const s=this._options(e);return this._drawable("curve",[this.lib.curve(t,s)],s)}path(t,e){const s=this._options(e),i=[];if(!t)return this._drawable("path",i,s);if(s.fill)if("solid"===s.fillStyle){let e={type:"path2Dfill",path:t};i.push(e)}else{const e=this._computePathSize(t);let n=[0,e[0],e[0],0],r=[0,0,e[1],e[1]],h=this.lib.hachureFillShape(n,r,s);h.type="path2Dpattern",h.size=e,h.path=t,i.push(h)}return i.push(this.lib.svgPath(t,s)),this._drawable("path",i,s)}_computePathSize(t){let e=[0,0];if(self.document)try{const s="http://www.w3.org/2000/svg";let i=self.document.createElementNS(s,"svg");i.setAttribute("width","0"),i.setAttribute("height","0");let n=self.document.createElementNS(s,"path");n.setAttribute("d",t),i.appendChild(n),self.document.body.appendChild(i);let r=n.getBBox();r&&(e[0]=r.width||0,e[1]=r.height||0),self.document.body.removeChild(i)}catch(t){}return e[0]*e[1]||(e=[this.canvas.width||100,this.canvas.height||100]),e[0]=Math.min(4*e[0],this.canvas.width),e[1]=Math.min(4*e[1],this.canvas.height),e}}class U extends F{async line(t,e,s,i,n){const r=this._options(n);return this._drawable("line",[await this.lib.line(t,e,s,i,r)],r)}async rectangle(t,e,s,i,n){const r=this._options(n),h=[];if(r.fill){const n=[t,t+s,t+s,t],a=[e,e,e+i,e+i];"solid"===r.fillStyle?h.push(await this.lib.solidFillShape(n,a,r)):h.push(await this.lib.hachureFillShape(n,a,r))}return h.push(await this.lib.rectangle(t,e,s,i,r)),this._drawable("rectangle",h,r)}async ellipse(t,e,s,i,n){const r=this._options(n),h=[];if(r.fill)if("solid"===r.fillStyle){const n=await this.lib.ellipse(t,e,s,i,r);n.type="fillPath",h.push(n)}else h.push(await this.lib.hachureFillEllipse(t,e,s,i,r));return h.push(await this.lib.ellipse(t,e,s,i,r)),this._drawable("ellipse",h,r)}async circle(t,e,s,i){let n=await this.ellipse(t,e,s,s,i);return n.shape="circle",n}async linearPath(t,e){const s=this._options(e);return this._drawable("linearPath",[await this.lib.linearPath(t,!1,s)],s)}async polygon(t,e){const s=this._options(e),i=[];if(s.fill){let e=[],n=[];for(let s of t)e.push(s[0]),n.push(s[1]);"solid"===s.fillStyle?i.push(await this.lib.solidFillShape(e,n,s)):i.push(await this.lib.hachureFillShape(e,n,s))}return i.push(await this.lib.linearPath(t,!0,s)),this._drawable("polygon",i,s)}async arc(t,e,s,i,n,r,h,a){const o=this._options(a),l=[];if(h&&o.fill)if("solid"===o.fillStyle){let h=await this.lib.arc(t,e,s,i,n,r,!0,!1,o);h.type="fillPath",l.push(h)}else l.push(await this.lib.hachureFillArc(t,e,s,i,n,r,o));return l.push(await this.lib.arc(t,e,s,i,n,r,h,!0,o)),this._drawable("arc",l,o)}async curve(t,e){const s=this._options(e);return this._drawable("curve",[await this.lib.curve(t,s)],s)}async path(t,e){const s=this._options(e),i=[];if(!t)return this._drawable("path",i,s);if(s.fill)if("solid"===s.fillStyle){let e={type:"path2Dfill",path:t};i.push(e)}else{const e=this._computePathSize(t);let n=[0,e[0],e[0],0],r=[0,0,e[1],e[1]],h=await this.lib.hachureFillShape(n,r,s);h.type="path2Dpattern",h.size=e,h.path=t,i.push(h)}return i.push(await this.lib.svgPath(t,s)),this._drawable("path",i,s)}}class W{constructor(t,e){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this._init(e)}_init(t){this.gen=new F(t,this.canvas)}get generator(){return this.gen}static createRenderer(){return new D}line(t,e,s,i,n){let r=this.gen.line(t,e,s,i,n);return this.draw(r),r}rectangle(t,e,s,i,n){let r=this.gen.rectangle(t,e,s,i,n);return this.draw(r),r}ellipse(t,e,s,i,n){let r=this.gen.ellipse(t,e,s,i,n);return this.draw(r),r}circle(t,e,s,i){let n=this.gen.circle(t,e,s,i);return this.draw(n),n}linearPath(t,e){let s=this.gen.linearPath(t,e);return this.draw(s),s}polygon(t,e){let s=this.gen.polygon(t,e);return this.draw(s),s}arc(t,e,s,i,n,r,h,a){let o=this.gen.arc(t,e,s,i,n,r,h,a);return this.draw(o),o}curve(t,e){let s=this.gen.curve(t,e);return this.draw(s),s}path(t,e){let s=this.gen.path(t,e);return this.draw(s),s}draw(t){let e=t.sets||[],s=t.options||this.gen.defaultOptions,i=this.ctx;for(let t of e)switch(t.type){case"path":i.save(),i.strokeStyle=s.stroke,i.lineWidth=s.strokeWidth,this._drawToContext(i,t),i.restore();break;case"fillPath":i.save(),i.fillStyle=s.fill,this._drawToContext(i,t,s),i.restore();break;case"fillSketch":this._fillSketch(i,t,s);break;case"path2Dfill":{this.ctx.save(),this.ctx.fillStyle=s.fill;let e=new Path2D(t.path);this.ctx.fill(e),this.ctx.restore();break}case"path2Dpattern":{let e=t.size,i=document.createElement("canvas");i.width=e[0],i.height=e[1],this._fillSketch(i.getContext("2d"),t,s),this.ctx.save(),this.ctx.fillStyle=this.ctx.createPattern(i,"repeat");let n=new Path2D(t.path);this.ctx.fill(n),this.ctx.restore();break}}}_fillSketch(t,e,s){let i=s.fillWeight;i<0&&(i=s.strokeWidth/2),t.save(),t.strokeStyle=s.fill,t.lineWidth=i,this._drawToContext(t,e),t.restore()}_drawToContext(t,e){t.beginPath();for(let s of e.ops){const e=s.data;switch(s.op){case"move":t.moveTo(e[0],e[1]);break;case"bcurveTo":t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5]);break;case"qcurveTo":t.quadraticCurveTo(e[0],e[1],e[2],e[3]);break;case"lineTo":t.lineTo(e[0],e[1])}}"fillPath"===e.type?t.fill():t.stroke()}}var B={canvas:(t,e)=>e&&e.async?new class extends W{_init(t){this.gen=new U(t,this.canvas)}async line(t,e,s,i,n){let r=await this.gen.line(t,e,s,i,n);return this.draw(r),r}async rectangle(t,e,s,i,n){let r=await this.gen.rectangle(t,e,s,i,n);return this.draw(r),r}async ellipse(t,e,s,i,n){let r=await this.gen.ellipse(t,e,s,i,n);return this.draw(r),r}async circle(t,e,s,i){let n=await this.gen.circle(t,e,s,i);return this.draw(n),n}async linearPath(t,e){let s=await this.gen.linearPath(t,e);return this.draw(s),s}async polygon(t,e){let s=await this.gen.polygon(t,e);return this.draw(s),s}async arc(t,e,s,i,n,r,h,a){let o=await this.gen.arc(t,e,s,i,n,r,h,a);return this.draw(o),o}async curve(t,e){let s=await this.gen.curve(t,e);return this.draw(s),s}async path(t,e){let s=await this.gen.path(t,e);return this.draw(s),s}}(t,e):new W(t,e),createRenderer:()=>W.createRenderer(),generator:(t,e)=>t&&t.async?new U(t,e):new F(t,e)};function X(t,e,s){return t.fillStyle=s,0}function V(t){var e=t[3],s=k(t[2]-e|0,e);return[l(s),l(s)]}function H(t,e,s){var i=t[3]*t[4]+3;return t[1].putImageData(e,s[0]*i,s[1]*i,0,0,i,i),0}var G=[function(t){var e=[0],s=[l(50)];return[t,function(){return e[0]=e[0]+1|0,3===e[0]&&(e[0]=0,s[0]=l(50)),s[0]}]}];function $(t,e,s,i){return[t,void 0!==s&&s,void 0!==e?e:1,G[0](t)[1]]}function Q(t,e){var s=t[0],i=s[1],n=s[0];switch(t[2]){case 0:var r=n-1;return[r<0?e-1:r,i];case 1:var h=n+1;return[h>=e?0:h,i];case 2:var a=i-1;return[n,a<0?e-1:a];case 3:var o=i+1;return[n,o>=e?0:o]}}function Z(t,e){if(t[2].length<3){var i=function(t){var e=t.first;if(null!==e)return s(e.content)}(t[2]);return function(t,e){switch(t){case 0:return 1!==e;case 1:return 0!==e;case 2:return 3!==e;case 3:return 2!==e}}(void 0!==i?i:M(t[1])[2],e)?function(t,e){var s={content:e,next:E},i=t.last;return null!==i?(t.length=t.length+1|0,i.next=s,t.last=s,0):(t.length=1,t.first=s,t.last=s,0)}(t[2],e):0}return 0}function j(t){return[k(t[2],t[3]),(e=5,s=function(t){return $([4-t,0],void 0,void 0)},function(t,e){if(t<=0)return 0;for(var s=[e(0),0],i=s,n=1;n<t;){var r=[e(n),0];i[1]=r,i=r,n=n+1|0}return s}(e,y(s))),{length:0,first:E,last:E}];var e,s}function K(t,e,s,i){return function(t,e){for(;;){var s=t;if(!s)return 0;e(s[0]),t=s[1]}}(t[1],y(function(n){return H(e,g(i,_(n[3],0)),function(t,e,s){var i=t[0],n=i[1],r=i[0],h=Q(t,e),a=h[1],l=h[0];switch(t[2]){case 0:return[o(r<l?l+1:r,l,s),n];case 1:return[o(r>l?l-1:r,l,s),n];case 2:return[r,o(n<a?a+1:n,a,s)];case 3:return[r,o(n>a?a-1:n,a,s)]}}(n,t[0],s))}))}function J(t,e){return t[1]?[[t[0],!1,t[2],t[3]],[[e[0],!0,t[2],e[3]],0]]:[t,[e,0]]}function Y(t){var e,s=function(t,e){if(e<0)throw new Error("getExn");for(var s=t,i=e;;){var n=i,r=s;if(!r)throw new Error("getExn");if(0===n)return r[0];i=n-1|0,s=r[1]}}(t[1],function(t){for(var e=t,s=0;;){var i=s,n=e;if(!n)return i;s=i+1|0,e=n[1]}}(t[1])-1|0);switch(s[2]){case 0:e=[s[0][0]+1,s[0][1]];break;case 1:e=[s[0][0]-1,s[0][1]];break;case 2:e=[s[0][0],s[0][1]+1];break;case 3:e=[s[0][0],s[0][1]-1]}return[t[0],O(t[1],[$(e,s[2],void 0),0]),t[2]]}function tt(t){return function(t){var e=M(t[1]),s=A(t[2]),i=void 0!==s?[e[0],!0,s,e[3]]:e;return[t[0],[i,S(t[1])],t[2]]}(function(t){var e=function(t){if(t){var s=t[1],i=t[0];if(s){if(s[1]){var n=e(s);return O(J(i,M(n)),S(n))}return J(i,s[0])}return[i,0]}return 0};return[t[0],e(t[1]),t[2]]}(function(t){return[t[0],P(t[1],function(e){return[Q(e,t[0]),e[1],e[2],e[3]]}),t[2]]}(t)))}function et(t,e){t[8]=e;var s=String(t[8]);return t[3].innerHTML=s,t[8]>t[7]?(t[7]=t[8],t[2].innerHTML=s,localStorage.setItem("highScore",s),0):0}function st(t,e){var s,i,n,r=g(t[5],_(t[4][1],0));return s=t[1],i=s[2],X(n=s[1],0,"white"),n.fillRect(0,0,i,i),H(t[1],r,t[4][0]),K(t[9],t[1],e,t[0])}function it(t){return t[9]=tt(t[9]),t[6]=function(t){for(var e=M(t[1]),s=S(t[1]);;){var i=s;if(i){var n=i[1],r=i[0];if(n){if(b(r[0],e[0]))return!0;s=n;continue}return b(r[0],e[0])}return!1}}(t[9]),t[6]?t:(b(M(t[9][1])[0],t[4][0])&&(et(t,t[8]+1|0),t[9]=Y(t[9]),t[4]=function(t){return[function(e){for(;;){var s=e;if(!R(P(t[9][1],function(t){return t[0]}),s,b))return s;e=V(t[1])}}(V(t[1])),t[4][1]]}(t)),t)}function nt(t){var e=function(t,s,i,n){var r=function(t,e){for(;;){var s=e,i=t;if(!(s>i[10]))return[i,s];e=s-i[10],t=it(i)}}(t,n+(s-i)),h=r[1],a=r[0];return st(a,h/a[10]),a[6]?0:(requestAnimationFrame(function(t){return e(a,t,s,h)}),0)};return requestAnimationFrame(function(s){return e(t,s,s,0)}),0}function rt(t){return[G[0](V(t)),!1,0,j(t)]}function ht(t){if(t[6]){var e=rt(t[1]);return t[4]=e[0],t[9]=e[3],t[6]=e[1],et(t,e[2]),nt(t)}return 0}function at(t,e){return w(m(50,function(){return function(t,e){var s=t[3];return t[6].rectangle(0,0,s,s,{fill:e,stroke:"black",roughness:1.1,strokeWidth:1.4,bowing:0})}(t,e)}),function(e){return function(t,e){var s=t[1],i=t[3]*t[4]+3;t[5].draw(e);var n,r,h=(n=i,r=i,s.getImageData(0,0,n,r));return X(s,0,"white"),s.fillRect(0,0,i,i),h}(t,e)})}function ot(t,e){var r,h=rt(t),a=at(t,"blue"),o=at(t,"red"),l=[a,t,u(i(document.getElementById("highScore"))),u(i(document.getElementById("score"))),h[0],o,h[1],parseInt(function(t,e){return void 0!==e?n(e):t}("0",(r=localStorage.getItem("highScore"),null===r?void 0:s(r)))),h[2],h[3],e];return l[2].innerHTML=String(l[7]),function(t){document.documentElement.addEventListener("keydown",function(e){if(!e.repeat){var s=function(t){switch(t){case"ArrowLeft":case"KeyA":return 0;case"ArrowRight":case"KeyD":return 1;case"ArrowDown":case"KeyS":return 3;case"ArrowUp":case"KeyW":return 2;default:return}}(e.code);void 0!==s&&Z(t[9],s)}return ht(t)});var e=u(i(document.getElementById("left"))),s=u(i(document.getElementById("right"))),n=u(i(document.getElementById("up"))),r=u(i(document.getElementById("down")));e.addEventListener("click",function(){return Z(t[9],0),ht(t)}),s.addEventListener("click",function(){return Z(t[9],1),ht(t)}),n.addEventListener("click",function(){return Z(t[9],2),ht(t)}),r.addEventListener("click",function(){return Z(t[9],3),ht(t)})}(l),l}function lt(){var t=u(i(document.body)),e=t.clientHeight,s=t.clientWidth;return.75*(e<s?e:s)}function ut(){var t,e,s=lt(),n=Math.ceil(s/25);return nt(ot(function(t){var e=t[4],s=t[2],i=t[0],n=String(s)+"px";if(1!==e){var r=String(s*e)+"px",h=i.style;h.setProperty("width",n,""),h.setProperty("height",n,""),i.setAttribute("width",r),i.setAttribute("height",r)}else i.setAttribute("width",n),i.setAttribute("height",n);return t[1].scale(e,e),t}(function(t,e,s){var i=B.canvas(t),n=window.devicePixelRatio;return[t,t.getContext("2d"),e,s,null==n?1:n,i,i.generator]}(u(i(document.getElementById("canvas"))),(t=s,e=n,Math.ceil(t/e+1)*e),n)),150))}return ut(),t.pageSize=lt,t.main=ut,t}({});
